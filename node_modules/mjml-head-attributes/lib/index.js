'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _compact = require('lodash/compact');

var _compact2 = _interopRequireDefault(_compact);

var _each = require('lodash/each');

var _each2 = _interopRequireDefault(_each);

var _filter = require('lodash/filter');

var _filter2 = _interopRequireDefault(_filter);

var _omit = require('lodash/omit');

var _omit2 = _interopRequireDefault(_omit);

var _assign = require('lodash/assign');

var _assign2 = _interopRequireDefault(_assign);

var _mjmlCore = require('mjml-core');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = {
  name: "mj-attributes",
  handler: function handler(element, _ref) {
    var defaultAttributes = _ref.defaultAttributes,
        cssClasses = _ref.cssClasses;

    (0, _each2.default)((0, _compact2.default)((0, _filter2.default)(element.children, function (child) {
      return child.tagName;
    })), function (elem) {
      var tagName = elem.tagName.toLowerCase();
      var attributes = _mjmlCore.helpers.dom.getAttributes(elem);

      if (tagName === 'mj-class') {
        return cssClasses[attributes.name] = (0, _assign2.default)(cssClasses[attributes.name], (0, _omit2.default)(attributes, ['name']));
      }

      defaultAttributes[tagName] = (0, _assign2.default)(defaultAttributes[tagName], attributes);
    });
  }
};